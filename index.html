<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>

	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
	<link rel="stylesheet" href="style.css">

	<script src="./functional-compiled.js"></script>
	<script src="template-factory.js"></script>
	<script src="template.js"></script>
	<script src="./gQuery-compiled.js"></script>
	<script src="data.js"></script>
</head>
<body>
	<header class="attached" id="site-header">
<!--        <div>Resume <span>Andrew Fountain</span></div>-->
		<nav>
			<ul id="navigation">
				<li data-section="#output-personal">me</li>
				<li data-section="#output-languages">languages</li>
				<li data-section="#output-frameworks" class="active">frameworks</li>
				<li data-section="#output-job">work</li>
				<li data-section="#course">education</li>
				<li data-section="#output-books">books</li>
				<li data-section="#output-blogs">blogs</li>
			</ul>
		</nav>
	</header>

    <main class="main" id="site-content">

	    <!-- <object type="image/svg+xml" data="vectors/scenery-no-truck.svg" class="scenery"></object> -->

        <object type="image/svg+xml" data="vectors/ice-creame-truck-smaller.svg" class="truck"></object>


        <div id="output-hero" class="hero">

        </div>
        <section id="output-personal" class="personal"></section>
        <section id="output-languages" class="languages"></section>
        <section id="output-frameworks" class="frameworks"></section>
        <section id="output-job" class="jobs__group"></section>
	    <section class="education" id="course">
		    <h2>Formal Education</h2>
		    <ul class="course__collection" id="output-education"></ul>
	    </section>
        <section id="output-books" class="books__group"></section>
        <section id="output-blogs" class="blogs__group"></section>

        <footer>
            <a href="http://www.bmspares.com.au/best-parts/">http://www.bmspares.com.au/best-parts/</a>
        </footer>

    </main>

<template id="hero">
	<div class="hero-inner" id="hero-inner">
		<h1>{{name}}</h1>
		<h4>I develop [ <span id="word">javascript</span> ] things</h4>
	</div>
</template>

<template id="personal">
	<div class="wrapper">
        <h2>About Me</h2>
	<div class="personal">
		<h3>{{name}}</h3>
		<div class="details">
			<ul class="personal__info">
				<li>{{address}}</li>
				<li>{{suburb}}</li>
				<li><a href="tel:{{phone}}">{{phone}}</a></li>
				<li><a href="mailto:{{email}}">{{email}}</a></li>
			</ul>
			<p>{{description}}</p>
			<ul class="personal__attributes tick-list">
				{{foreach attributes as attribute}}
					<li class="personal__attribute-item"><span>{{attribute}}</span></li>
				{{/foreach}}
			</ul>
		</div>
	</div>
	</div>
</template>

<template id="job">
	<div class="slideshow">
		<span class="slideshow-nav" id="slideshow-nav-left"></span>
		<ul class="slideshow-wrapper">
			{{foreach jobs as job}}
				<li class="slide vertical-center-parent">
					<div class="job vertical-center-element">
					<h3><a href="{{job.url}}" target="_blank">{{job.company}}</a></h3>
						<div class="details">
							<ul class="company__info">
								<li class="job__address">{{job.address}}</li>
								<li class="job__title">{{job.title}}</li>
								<li class="job__dates">{{job.dates}}</li>
							</ul>
							<h4>Responsibilities</h4>
							<ul class="job__details">
								{{foreach job.responsibilities as responsibility}}
								<li>{{responsibility}}</li>
								{{/foreach}}
							</ul>
						</div>
					</div>
				</li>
			{{/foreach}}
		</ul>
		<span class="slideshow-nav" id="slideshow-nav-right"></span>
	</div>
</template>

<template id="education">
	<li class="education">
		<h3><a href="{{course.url}}" target="_blank">{{course.institution}}</a></h3>
		<div class="details">
			<h4>{{course.course}}</h4>
			<p>{{course.dates}}</p>
		</div>
	</li>
</template>

<template id="books">
    <div class="wrapper">
        <h2>Books that changed the way I think</h2>
        <div class="books">
            {{foreach books as book}}
            <div class="book">
                <div class="book__heading">
                    <h4><a href="{{book.url}}" target="_blank">{{book.title}}</a></h4>
                </div>
                <div class="book__details">
                    <ul class="books__info">
                        <li>{{book.author}}</li>
                        <li>{{book.year}}</li>
                        <li>{{book.subject}}</li>
                    </ul>
                    <p>{{book.learnt}}</p>
                </div>
            </div>
            {{/foreach}}
        </div>
    </div>
</template>

<template id="blogs">
	<div class="wrapper">
        <h2>Blogs that influence me</h2>
		<div class="blogs">
			{{foreach blogs as blog}}
				<h3><a href="{{blog.url}}">{{blog.title}}</a></h3>
			{{/foreach}}
		</div>
	</div>
</template>

<template id="languages">
	<div class="wrapper">
        <h2>Languages I know</h2>
		<div class="container">
			{{foreach languages as framework}}
			<figure class="framework">
				<header>
					<h3>
						<a href="{{framework.url}}">{{framework.name}}</a>
					</h3>
				</header>
				<div class="framework__info">
					<ul class="framework__info-collection">
						<li>{{framework.level}}</li>
						<li>{{framework.score}}</li>
						<li>{{framework.time}}</li>
					</ul>
					<div class="progress" data-score="{{framework.score}}">
						<div class="progress-inner"></div>
					</div>
					<p class="framework__info-description">{{framework.desc}}</p>

				</div>
			</figure>
			{{/foreach}}
		</div>
	</div>
</template>

<template id="frameworks">
	<div class="wrapper">
        <h2>Frameworks and libraries I have played with</h2>
        <div class="container">
            {{foreach frameworks as framework}}
            <figure class="framework">
                <header>
                    <h3>
                        <a href="{{framework.url}}">{{framework.name}}</a>
                        <p>{{framework.language}}</p>
                    </h3>
                </header>
                <div class="framework__info">
                    <ul class="framework__info-collection">
                        <li>{{framework.level}}</li>
                        <li>{{framework.score}}</li>
                        <li>{{framework.time}}</li>
                    </ul>
                    <div class="progress" data-score="{{framework.score}}">
                        <div class="progress-inner"></div>
                    </div>
                    <p class="framework__info-description">{{framework.desc}}</p>

                </div>
            </figure>
            {{/foreach}}
        </div>
	</div>
</template>

<script>

	var
		template = function( id ){
			var template = Template.get( id ),
			    output = document.getElementById( 'output-' + id ),
			    wrapper;
			return function( vars ){
				wrapper = document.createElement( 'div' );
				wrapper.innerHTML = template.send( vars );
				output.appendChild( wrapper.children[0] );
			}
		},
		heroTemplate        = template('hero'),
		personalTemplate    = template('personal'),
		jobTemplate         = template('job' ),
		booksTemplate       = template('books'),
		blogsTemplate       = template('blogs' ),
		languagesTemplate   = template('languages' ),
		frameworksTemplate  = template('frameworks' ),
		educationTemplate      = template('education');


	personalTemplate( resume.personal );
	heroTemplate( resume.personal );
	languagesTemplate( { languages: resume.languages, frameworks: resume.frameworks } );
	frameworksTemplate( { frameworks: resume.frameworks } );
	jobTemplate( {jobs: resume.work} );
	booksTemplate({books: resume.books});
	blogsTemplate({blogs: resume.blogs});

	resume.education.forEach(function(course){
		educationTemplate({course: course});
	});

	function Slideshow(){

		this.currentSlide = 0;
		this.length = 0;
		this.width = 0;

	}

	var scrollSpy = (function(){

		var
			stopped = true,
			offset = 0,
			events = [];

		function ScrollEvt(){}
		ScrollEvt.prototype = {};

		function SpyEvt( params ){
			extend( this, params );
		}

		extend( SpyEvt.prototype, {

			update: function( offset ){

				if( offset > this.offset && this.persist === false ){

					this.cb.call( this.el, this.el, offset );
					return false;
				}

				return true;
			}

		});

		function Paralax( params ){
			extend( this, params );
		}

		extend(Paralax.prototype, {

			update: function( offset ){
				return this.cb.call( this.el, this.curr, this.offset, offset );
			}

		});

		return {

			run: function run( cb ){

				function update(){

					offset = window.scrollY;

					events = events.filter(function( event ){

						return event.update( offset );

					});

					if( events.length ){
						stopped = false;
						window.setTimeout( function(){
							window.requestAnimationFrame(update)
						}, 120 );
					} else {
						stopped = true;
					}
				}

				update();

			},

			paralax: function paralax( el, cb ){

				if( isElement( el ) || isString( el ) ){
					el = $(el);
					offset = el.offset()
				} else {
					offset = window.scrollY;
				}

				events.push( new Paralax({
					el     : el,
					cb     : cb,
					offset : offset,
					persist: true
				}));


				if( stopped ){
					this.run();
				}

			},

			bind: function( elOrOffset, cb ){

				var offset = null;

				if (isString( elOrOffset ) ) {
					elOrOffset = $( elOrOffset );
					offset     = elOrOffset.offset();
				} else {
					offset = elOrOffset
				}

				events.push( new SpyEvt({
					el: elOrOffset,
					cb: cb,
					offset: offset - (window.innerHeight * .5),
					persist: false
				}));

				if( stopped ){
					this.run();
				}

			}

		}

	})();


	var paralax = (function(){

		var events = [],
		    scrolling = false,
		    timeout = null;

		/**
		 * super efficient scrolling request annimation frome
		 *
		 * this function will bind an event to the dom scroll event,
		 * and continually cancel the callback while scrolling. when
		 * when scrolling is complete the `scrolling` variable will be
		 * set to false which will end the requestAnimationFrame cycle
		 */
		$( window ).on( 'scroll', function(){
			if( scrolling === false && events.length ){
				console.log( 'started scrolling', timeout );
				_render();
			}
			scrolling = true;
			window.clearTimeout( timeout );
			timeout   = window.setTimeout( function(){
				scrolling = false;
				console.log( 'stopped scrolling', timeout );
			}, 80 );
		} );

		function Paralax( params ){
			extend( this, params );
		}

		extend(Paralax.prototype, {
			update: function( timestamp ){

				var offset = window.scrollY,
				    heightOffset = window.innerHeight * 1;

				this.height = this.el.css( 'height' );

				this.curr = offset - this.offset;
				this.bottom = this.curr + heightOffset;

				if( ( this.curr > 0 - heightOffset ) && ( this.curr < this.height ) ){

					this.progress = (this.bottom / this.height) * 100;

					return this.cb.call( this, this.progress, this );

				}

				return true; // persistent animation
			}
		});

		return {
			add: function( el, cb ){

				var offset;

				if( isElement(el) || isString(el)){
					el = $(el);
					offset = el.offset();
				} else {
					offset = window.offsetY;
				}

				events.push( new Paralax({
					el: el,
					height: el.css('height'),
					progress: 0,
					offset: offset,
					curr: offset,
					cb: cb
				}));
			}
		};

		function _render(){

			events = events.filter(function( event ){

				return event.update( Date.now() );
			});

			if( events.length && scrolling ){
				window.requestAnimationFrame(_render);
			}

		}

	})();

	paralax.add( '#output-frameworks', function( progress, para ){

		var elOffsets = [],
		    offset = window.scrollY;


		this.el.find('.framework' ).each(function( el ){
			var $el = $(el);

			elOffsets.push( para.bottom - el.offsetTop );
		});

//		console.log( 'progress', elOffsets, para );
		return true;

	});

	scrollSpy.bind(200, function(){
		$('header' ).removeClass('attached');
	});

	scrollSpy.bind('#output-personal', function( el, offset ){

		$( '.personal__attribute-item' ).stagger( ( ii ) => ii * 500, [0,0], {
			opacity: 1
		}, 2000 );

		//$('.personal__attribute-item' ).animateFrom([200,200], {}, 2000);

	});

	scrollSpy.bind('#output-languages', function( $el, offset ){

		$el.find('.framework').each( function( el, ii ){

			var $this     = $( this ),
			    $progress = $this.find( '.progress' ),
			    $header   = $this.find( 'header' ),
			    width     = parseInt( $progress.css( 'width' ) ),
			    $inner    = $this.find( '.progress-inner' ),
			    progress  = parseInt( $progress.data( 'score' ) ) / 10;

			$inner.animate( null, {
				width: ((width * progress / width) * 100) + '%',
				background: '#3cf'
			}, 2000 );

			$header.animate( null, {
				background: '#3cf'
			}, 2000);
		});

	});

	scrollSpy.bind( '#output-frameworks', function( $el, offset ){

        $el.find('.framework').each(function (el, ii) {

            var $this = $(this),
                $progress = $this.find('.progress'),
                $header = $this.find( 'header' ),
                width = parseInt($progress.css('width')),
                $inner = $this.find('.progress-inner'),
                progress = parseInt($progress.data('score')) / 10;

            $inner.animate( null, {
	            width: ((width * progress / width) * 100) + '%'
            }, 2000);

        });
	});

	extend(Slideshow.prototype, {
		init: fluent(function(){

			var self = this,
			    $window = $(window);

			this.slideshow = $('.slideshow');
			this.wrapper   = this.slideshow.find( '.slideshow-wrapper' );
			this.slides    = this.wrapper.children();
			this.length    = this.slides.length;
			this.left      = this.slideshow.find( '#slideshow-nav-left' );
			this.right     = this.slideshow.find( '#slideshow-nav-right' );

			this.left.on( 'click', function( e ){
				self.setLeft('backward' );
			});

			this.right.on( 'click', function( e ){
				self.setLeft('forward' );
			});

			$window.on('resize', function( e ){

				var
					width = parseFloat(self.slideshow.css('width') ),
					pos = width * self.currentSlide;

				self.wrapper.matrix(-pos, 0);
				self.width = width;
			});

		}),
		setLeft: function( direction ){
			var
				self    = this,
				width   = this.width || parseFloat( this.slideshow.css( 'width' ) ),
				matrix  = this.wrapper.matrix(),
				curr    = matrix[ 4 ],
			    val;

			console.log( this.currentSlide );

			if (direction === 'forward'){
				if( this.currentSlide >= this.length - 1 ){
					return false;
				}
				this.currentSlide++;
				val = ( curr - width );
			} else {
				if( this.currentSlide <= 0 ){
					return false;
				}
				this.currentSlide--;
				val = ( curr + width );
			}

			this.width = width;

			this.wrapper.animate( [val, 0], null, 1000, function(){

			});
		}

	});


	function words(){

		var words = 'javascript node php css scss less html awesome simple complex clean functional oop asynchronous awesome elegant optimised abstracted'.split(' '),
		    wordEl = document.getElementById('word');

		function show(){

			var word = words[ Math.floor( Math.random() * words.length ) ],
			    rect;
			wordEl.style.opacity = 1;
			wordEl.innerHTML = word;

			window.setTimeout( function(){

				fadeOut( wordEl, function(){
					window.requestAnimationFrame( show );
				});

			}, (Math.random() * 500) + 500 );

		}
		show();

		function fadeIn( el ){
			var rect = el.getBoundingClientRect();

			el.style.width = (rect.width / 16) + 'em';
			console.log( 'fadeIn', rect.width );
		}

		function fadeOut( el, cb ){
			var rect = el.getBoundingClientRect(),
			    random = Math.floor(Math.random() * 250) + 250;

			el.style.width = (rect.width / 16) + 'em';
			//console.log( rect.width );

			$(el).animate(null, {opacity: 0}, random, function( el ){
				cb.call( this, el );
			});
		}

	}

	words();

	var slideshow = new Slideshow().init();

//    $(window).on('resize', function( e ){
//        if( isConsoleOpen() ){
//            console.log('Awesome you looked');
//        }
//    });

    function isConsoleOpen(){
        var start = performance.now();
        console.log( start );
        return performance.now() - start > 2000;
    }

    var c = {
        styles: {
            header: {
                background: 'red',
                color: 'white',
                padding: '1em'
            }
        },
        style: function( type ){
            return this.styles[ type ];
        },
        title: function( text ){
            console.log('%c ' + text + ' ', 'background:#f02673;color:white;font-size:2em;display:block;width:100%');
        },
        header: function( text ){
            console.log('%c ' + text + ' ', 'background:#f9f9f9;color:white;font-size:1.5em');
        },
        list: function( text ){
            console.log('%c > ', 'background:#f02673;color:white;font-size:1em', text );
        }
    };

    $('.truck').animate( [200, 0], {opacity: 1}, 4000, function(){
        scrollSpy.bind(800, function () {
            $('.truck').animate([-600, 0], {left: '-600px'}, 4000);
        });
    });


	$('#navigation')
		.find('li' )
		.on('click', function( e ){

			var $this = $(this),
			    section = $this.data('section');

			$(section ).scrollTo();

		});

	function rand(){
		return (Math.random() * 2) - 1;
	}

//	$(window ).on('scroll', function( e ){
//
//		console.log( e );
//
//	});

//    console.clear();
//    c.title('Awesome you must like seeing how things work too');
//    c.list('I live in here, so maybe I should tell you what\'s happening behind the scenes');

</script>

<script type="text/x-markdown" id="scene-header">
### to navigate
you can more forward or backwards with `prev() || next()` or go directly to a scene with `go('intro|utilities|templates|style|about')` eol
</script>

<script type="text/x-markdown" id="scene-intro">
# Awesome you must like seeing how things work too!

I live in here most of the time, so maybe I should tell you what's happening behind the scenes. eol
I want to show that I really understand all the languages that I listed, so knocked this up from scratch in my spare time after work. eol

All the js is vanilla flavoured... although it will look strangely like jQuery, but that's because I understand how jQuery was built, and what purpose it serves. eol
</script>

<script type="text/x-markdown" id="scene-utilities">
# utilities
### dom library
I use jQuery every day, but only use a few methods generally so this contains only the functionality I required to put this demo site together. Unfortunately I'm not very creative when it comes to naming things so I called it gQuery lol. eol

### animations
All the animation is done through an animation stack, similar to jQuery animate or greensock, it's pretty basic at the moment and doesn't use the more efficient css matrix, but I hope you can
forgive me. eol

### utilities
I have included a functional library based on everything I learnt in allonge. I mentioned it in the books section. Seriously if you haven't yet read it, do yourself a favor. It really changed everything for me, although I have been re-reading it over and over to grok the shit out of it. eol
</script>

<script type="text/x-markdown" id="scene-templates">
# templates
### template engine - template.js & template-factory.js
The crowning Jewell in this site and something I am really proud of is the templating engine. I have never seen anything that precompiles templates to a function that just returns a string. Doing templates this way means they are transportable between node and the frontend, easy to include in a website, and have no dependencies, plus it's a few orders of magnitudes faster to get another template. I do need to look into security risks associated with doing things this way, but that will come later. eol

### a little more about it:
+ is able to loop through an array
+ saves the current scope of the variables
</script>

<script type="text/x-markdown" id="scene-style">
# style

### scss
Styling was done in scss, and the grid was in flexbox, I'm still getting my head around flexbox it's use, but seems to be working well. eol

### clipart
The clipart is all canvas. The only thing I didn't write for this site is the canvas library. It's pretty cool, I started just as I was nearing the end of TAFE, but got a job so ran out of time. It's purpose was to teach me how to use Objects in Javascript while reading Addy Osmani's book. The idea behind the library, is you can create an svg in illustrator, then use the co-ordinates to create assets. The next step was to use ajax to pull in an svg and read the file to generate the assets, then add animation. eol
</script>

<script type="text/x-markdown" id="scene-about">
# about me.
I love this stuff, I spend all my time developing, but I'm a bit of a programming cowboy, a Junior - Mid developer with a lot of passion. I have little concept of time, like a beer and a laugh, but sometimes need to be on my own, I try not to take life too seriously, because when I do shit get's real. eol

### cool story bro, but why do you want another job
My current work doesn't really appreciate what javascript can offer, and doesn't have any senior developers who are capable of teaching me anything about scaleable rock solid front and back end architecture, so I am really looking for a company that has seasoned developers who's brains I can pick and learn something from, I don't need my hand held, but would like the oportunity to discuss the application architecture with experienced professionals before begining a task. eol
I unfortunately have not been on any projects while in my current role as they have placed me in website support for the past year. it's killing me inside so looking to move on to bigger and better things. eol
</script>

<script type="text/x-markdown" id="scene-contact">
# if you still wanna have a chat
I hid the contact details on the site, you can send me an email using the function eol
`contact( name, company, email, phone, text )` and through the magic of ajax I'll get the notification, you're in the console now so you may aswell send it off ;-) eol
</script>


    <script>

	    (function(){
		    'use strict';

		    let index  = 0,
		        scenes = [
			        'intro',
			        'utilities',
			        'templates',
			        'style',
			        'about',
			        'contact'
		        ];

	        const markdownTags = {
	            '#': function (text) {
	                console.log('%c' + text.substr(1), 'color:#f02673;font-size:3em;display:block;width:100%');
	            },
	            '##': function (text) {
	                console.log('%c ' + text + '  ', 'background:#f02673;color:white;font-size:1.5em');
	            },
	            '###': function (text) {
	                console.log('%c ' + text + '  ', 'background:#ccc;color:white;font-size:1.2em;line-height:2em;');
	            },
	            '+': function (text) {
	                console.log('%c > ', 'background:#f02673;color:white;font-size:1em', text);
	            }
	        };

	        function markdownToConsole(id){
	            // console.clear();
	            var md = $(id).html().split('\n');

	            md.forEach(function( line ){
	                var match;

	                if( ( match = line.match(/([#+]+)(.*)/) ) ){
	                    markdownTags[ match[1] ].call(console, match[2]);
	                } else {
		                if( (match = line.match(/((?:.{0,100})[^ ]+\s)/g) ) ){
			                match.forEach( function( line ){
				                console.log( '%c' + line, 'font-size:1em;line-height:2em;' );
			                } );
		                } else {
			                console.log( '%c' + line, 'font-size:1em;line-height:2em;' );
		                }
	                }

	            });

	        }

		    window.next = function next(){
			   index < scenes.length - 1 && _show( scenes[ ++index ] );
		    };

		    window.prev = function prev(){
			    index > 0 && _show( scenes[ --index ] );
		    };

		    window.go  = function go( scene ){

			    let newIndex;

			    if( (newIndex = scenes.indexOf( scene )) > -1 ){
				    index = newIndex;
				    _show( scene );
			    }
		    };

		   function _nav( scene ){
			   let str = '';
			   scenes.forEach(function( s ){
				   if( scene === s ){
					   str += '  [' + s + ']  ';
				   } else {
					   str += '  ' + s + '  ';
				   }
			   });
			   console.log('%c ' + str, 'background:#f02673;color:white;font-size:1.5em;text-align:center');
			   console.log("you can navigate with `prev()` || `next() || `go('intro|utilities|templates|style|about')`")
		   }

		    function _show( scene ){
			    console.clear();
				_nav( scene );
			    markdownToConsole( '#scene-' + scene );
		    }

		  //_show('intro');

	    })();

//	    $( window ).on('wheel', function( e ){
//		   console.log( (-1 / 40 * e.wheelDeltaY ) );
//	    });
    </script>

</body>
</html>


